---
import CTAButton from "./CTAButton.astro";
import StarRating from "./StarRating.astro";
import CompareTable from "./CompareTable.astro";

type School = {
  name: string;
  logoUrl?: string | null;
  officialUrl: string;
  rating?: number | null;
  priceText?: string | null;
  hoursText?: string | null;
  trialText?: string | null;
  points?: string[];
  recommendedFor?: string[];
};

type Ranking = {
  title: string;
  items: { id: string; data: School }[];
};

type Props = {
  overall: Ranking;
  daily: Ranking;
  business: Ranking;
  /** How many columns to show in compare table */
  columns?: number;
};

const { overall, daily, business, columns = 4 } = Astro.props satisfies Props;

const sliceCols = (r: Ranking) => ({ ...r, items: r.items.slice(0, columns) });
const o = sliceCols(overall);
const d = sliceCols(daily);
const b = sliceCols(business);
---

<section class="rounded-2xl border border-zinc-200 bg-white p-3 shadow-sm sm:p-4">
  <input class="peer/ct-overall sr-only" type="radio" name="comparetab" id="ct-overall" checked />
  <input class="peer/ct-daily sr-only" type="radio" name="comparetab" id="ct-daily" />
  <input class="peer/ct-business sr-only" type="radio" name="comparetab" id="ct-business" />

  <div class="grid h-[50px] grid-cols-3 items-end gap-[10px] bg-[#ecf9fe] px-[2%] text-zinc-600
    peer-checked/ct-overall:[&_.tab-overall]:h-full peer-checked/ct-overall:[&_.tab-overall]:bg-[linear-gradient(to_top,#FFFF0D,#FFFFA3_10%,#FFFFA3_100%)] peer-checked/ct-overall:[&_.tab-overall]:text-zinc-900 peer-checked/ct-overall:[&_.tab-overall]:shadow-[2px_0px_4px_#999]
    peer-checked/ct-daily:[&_.tab-daily]:h-full peer-checked/ct-daily:[&_.tab-daily]:bg-[linear-gradient(to_top,#FFFF0D,#FFFFA3_10%,#FFFFA3_100%)] peer-checked/ct-daily:[&_.tab-daily]:text-zinc-900 peer-checked/ct-daily:[&_.tab-daily]:shadow-[2px_0px_4px_#999]
    peer-checked/ct-business:[&_.tab-business]:h-full peer-checked/ct-business:[&_.tab-business]:bg-[linear-gradient(to_top,#FFFF0D,#FFFFA3_10%,#FFFFA3_100%)] peer-checked/ct-business:[&_.tab-business]:text-zinc-900 peer-checked/ct-business:[&_.tab-business]:shadow-[2px_0px_4px_#999]
  ">
    <label
      for="ct-overall"
      class="tab tab-overall cursor-pointer rounded-t-xl bg-[#d1d1d1] px-3 py-1 text-center text-sm font-extrabold leading-tight transition hover:bg-zinc-200"
    >
      <div class="grid h-[80%] place-items-center">
        <span class="grid grid-rows-2 leading-tight">
          <span class="block">{o.title}</span>
          <span class="block select-none text-transparent" aria-hidden="true">英会話</span>
        </span>
      </div>
    </label>
    <label
      for="ct-daily"
      class="tab tab-daily cursor-pointer rounded-t-xl bg-[#d1d1d1] px-3 py-1 text-center text-sm font-extrabold leading-tight transition hover:bg-zinc-200"
    >
      <div class="grid h-[80%] place-items-center">
        <span class="grid grid-rows-2 leading-tight">
          <span class="block">日常</span>
          <span class="block">英会話</span>
        </span>
      </div>
    </label>
    <label
      for="ct-business"
      class="tab tab-business cursor-pointer rounded-t-xl bg-[#d1d1d1] px-3 py-1 text-center text-sm font-extrabold leading-tight transition hover:bg-zinc-200"
    >
      <div class="grid h-[80%] place-items-center">
        <span class="grid grid-rows-2 leading-tight">
          <span class="block">ビジネス</span>
          <span class="block">英会話</span>
        </span>
      </div>
    </label>
  </div>

  <div class="mt-4 hidden peer-checked/ct-overall:block">
    <CompareTable ranking={o} />
  </div>
  <div class="mt-4 hidden peer-checked/ct-daily:block">
    <CompareTable ranking={d} />
  </div>
  <div class="mt-4 hidden peer-checked/ct-business:block">
    <CompareTable ranking={b} />
  </div>
</section>

