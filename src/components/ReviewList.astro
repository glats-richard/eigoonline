---
import StarRating from "./StarRating.astro";

type Review = {
  age: string;
  rating: number;
  body: string;
  improvementPoints?: string | null;
  companyResponse?: string | null;
  studyPeriod?: string | null;
};

type Props = {
  title: string;
  items: Review[];
};

const { title, items } = Astro.props satisfies Props;
---

<section class="mt-4 rounded-2xl border border-zinc-200 bg-white p-4 shadow-sm">
  <h4 class="text-base font-extrabold text-zinc-900">{title}</h4>
  <div class="mt-3 grid gap-3">
    {items.slice(0, 3).map((r) => (
      <article class="rounded-xl border border-zinc-200 bg-zinc-50 p-4">
        <div class="flex items-center justify-between gap-3">
          <div class="text-sm font-extrabold text-zinc-800">
            {r.age}
            {r.studyPeriod && (
              <span class="ml-2 text-xs font-normal text-zinc-500">
                (学習期間 {r.studyPeriod})
              </span>
            )}
          </div>
          <div class="flex items-center gap-2">
            <StarRating value={r.rating} />
          </div>
        </div>
        <p class="mt-2 text-sm leading-relaxed text-zinc-700">{r.body}</p>
        {r.improvementPoints ? (
          <dl
            class="mt-3 rounded-lg border border-zinc-200 bg-white/60 p-3"
            data-review-negative-notes
          >
            <div>
              <dt class="text-xs font-extrabold text-zinc-600">改善点</dt>
              <dd class="mt-1 text-sm leading-relaxed text-zinc-700">
                {r.improvementPoints}
              </dd>
            </div>
            {r.companyResponse ? (
              <div class="mt-3 border-t border-zinc-200 pt-3">
                <dt class="text-xs font-extrabold text-zinc-600">企業からの回答</dt>
                <dd class="mt-1 text-sm leading-relaxed text-zinc-700">
                  {r.companyResponse}
                </dd>
              </div>
            ) : null}
          </dl>
        ) : null}
      </article>
    ))}
  </div>
</section>

